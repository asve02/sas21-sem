<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ashish Verma">
<meta name="dcterms.date" content="2025-11-25">

<title>Analysis of Arctic prokaryotes using Scanning electron microscopy (SEM) and -energy dispersive X-ray spectroscopy (SEM-EDX)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="sas21-sem_files/libs/clipboard/clipboard.min.js"></script>
<script src="sas21-sem_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="sas21-sem_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="sas21-sem_files/libs/quarto-html/popper.min.js"></script>
<script src="sas21-sem_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="sas21-sem_files/libs/quarto-html/anchor.min.js"></script>
<link href="sas21-sem_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="sas21-sem_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="sas21-sem_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="sas21-sem_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="sas21-sem_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-packages-and-libraries" id="toc-load-packages-and-libraries" class="nav-link active" data-scroll-target="#load-packages-and-libraries">Load packages and libraries</a></li>
  <li><a href="#proportion-of-cell-shapes" id="toc-proportion-of-cell-shapes" class="nav-link" data-scroll-target="#proportion-of-cell-shapes">Proportion of cell shapes</a></li>
  <li><a href="#sem-image-showing-morphological-features" id="toc-sem-image-showing-morphological-features" class="nav-link" data-scroll-target="#sem-image-showing-morphological-features">SEM image showing morphological features</a></li>
  <li><a href="#statistical-tests-specific-to-cell-shape-between-depths" id="toc-statistical-tests-specific-to-cell-shape-between-depths" class="nav-link" data-scroll-target="#statistical-tests-specific-to-cell-shape-between-depths">Statistical tests: specific to cell shape between depths</a></li>
  <li><a href="#statistical-tests-specific-to-cell-shape-between-seabasins" id="toc-statistical-tests-specific-to-cell-shape-between-seabasins" class="nav-link" data-scroll-target="#statistical-tests-specific-to-cell-shape-between-seabasins">Statistical tests: specific to cell shape between seabasins</a></li>
  <li><a href="#chi-square-test-finding-association-of-morphological-features-between-epipelagic-and-mesopelagic-layers" id="toc-chi-square-test-finding-association-of-morphological-features-between-epipelagic-and-mesopelagic-layers" class="nav-link" data-scroll-target="#chi-square-test-finding-association-of-morphological-features-between-epipelagic-and-mesopelagic-layers">Chi-square test: Finding association of morphological features between epipelagic and mesopelagic layers</a></li>
  <li><a href="#chi-square-test-results" id="toc-chi-square-test-results" class="nav-link" data-scroll-target="#chi-square-test-results">Chi-square test results</a></li>
  <li><a href="#chi-square-test-results-seabasin-specific-analysis" id="toc-chi-square-test-results-seabasin-specific-analysis" class="nav-link" data-scroll-target="#chi-square-test-results-seabasin-specific-analysis">Chi-square test results: seabasin-specific analysis</a></li>
  <li><a href="#chi-square-table" id="toc-chi-square-table" class="nav-link" data-scroll-target="#chi-square-table">Chi-square table</a></li>
  <li><a href="#elemental-analysis-of-arctic-prokaryotes-using-sem-edx" id="toc-elemental-analysis-of-arctic-prokaryotes-using-sem-edx" class="nav-link" data-scroll-target="#elemental-analysis-of-arctic-prokaryotes-using-sem-edx">Elemental analysis of Arctic prokaryotes using SEM-EDX</a></li>
  <li><a href="#wrap-and-combine-figures-in-one-plot" id="toc-wrap-and-combine-figures-in-one-plot" class="nav-link" data-scroll-target="#wrap-and-combine-figures-in-one-plot">Wrap and combine figures in one plot</a></li>
  <li><a href="#distribution-of-morphological-features-in-epipelagic-and-mesopelagic-depth-layers" id="toc-distribution-of-morphological-features-in-epipelagic-and-mesopelagic-depth-layers" class="nav-link" data-scroll-target="#distribution-of-morphological-features-in-epipelagic-and-mesopelagic-depth-layers">Distribution of morphological features in epipelagic and mesopelagic depth layers</a></li>
  <li><a href="#molar-percentages-between-prokaryotic-cells-and-vesicle-like-structures" id="toc-molar-percentages-between-prokaryotic-cells-and-vesicle-like-structures" class="nav-link" data-scroll-target="#molar-percentages-between-prokaryotic-cells-and-vesicle-like-structures">Molar percentages between prokaryotic cells and vesicle like structures</a></li>
  <li><a href="#combined-figures-morphological-features-and-mol-comaprison" id="toc-combined-figures-morphological-features-and-mol-comaprison" class="nav-link" data-scroll-target="#combined-figures-morphological-features-and-mol-comaprison">Combined figures: morphological features and mol% comaprison</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis of Arctic prokaryotes using Scanning electron microscopy (SEM) and -energy dispersive X-ray spectroscopy (SEM-EDX)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ashish Verma <a href="mailto:ashish.csirihbt@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 25, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="load-packages-and-libraries" class="level1">
<h1>Load packages and libraries</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"readxl"</span>,<span class="st">"tidyverse"</span>,<span class="st">"ggplot2"</span>,<span class="st">"broom"</span>,<span class="st">"viridis"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"patchwork"</span>,<span class="st">"cowplot"</span>,<span class="st">"rstatix"</span>,<span class="st">"zoo"</span>,<span class="st">"scales"</span>,<span class="st">"ggpubr"</span>,<span class="st">"magick"</span>,<span class="st">"grid"</span>,<span class="st">"FSA"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dunn.test"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Install missing packages</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pkg <span class="cf">in</span> packages) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(pkg)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages without printing output</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">walk</span>(packages, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="proportion-of-cell-shapes" class="level1">
<h1>Proportion of cell shapes</h1>
<p><a href="#fig-4a" class="quarto-xref">Figure&nbsp;1</a> shows the proportion of cell shape distribution between the epipelagic and mesopelagic depth layers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Read a specific sheet by name</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sem <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"./data/rawdata.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"cellcounts"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Count cells</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>cells_counts <span class="ot">&lt;-</span> sem <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(shape, depth_category) <span class="sc">|&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cells_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   shape       depth_category total
   &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;
 1 Cocci       Lower             12
 2 Cocci       Upper             58
 3 Rods        Lower             30
 4 Rods        Upper             75
 5 Spirals     Lower              2
 6 Spirals     Upper              6
 7 Spirochetes Lower              2
 8 Spirochetes Upper              1
 9 Vibrioid    Lower              6
10 Vibrioid    Upper             37</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Estimating proportion</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cells_prop <span class="ot">&lt;-</span> sem <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(depth_category) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cells_prop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 8
# Groups:   depth_category [2]
   filtration seabasin depth_category depth_range   shape criteria     n    prop
   &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 Yes        Amundsen Upper          Upper (10-45… Rods  Yes         20 0.113  
 2 Yes        Amundsen Upper          Upper (10-45… Vibr… Yes         20 0.113  
 3 Yes        Amundsen Upper          Upper (10-45… Cocci Yes          8 0.0452 
 4 Yes        Amundsen Upper          Upper (10-45… Spir… Yes          5 0.0282 
 5 Yes        Amundsen Upper          Upper (10-45… Spir… Yes          1 0.00565
 6 Yes        Amundsen Lower          Lower (274-5… Rods  Yes          6 0.115  
 7 Yes        Amundsen Lower          Lower (274-5… Vibr… Yes          2 0.0385 
 8 Yes        Amundsen Lower          Lower (274-5… Cocci Yes          2 0.0385 
 9 Yes        Amundsen Lower          Lower (274-5… Spir… Yes          1 0.0192 
10 Yes        Makarov  Upper          Upper (10-45… Rods  Yes         40 0.226  
# ℹ 14 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Recode depth category and convert to factor</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>cells_prop <span class="ot">&lt;-</span> cells_prop <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      depth_category <span class="sc">==</span> <span class="st">"Upper"</span> <span class="sc">~</span> <span class="st">"Epipelagic</span><span class="sc">\n</span><span class="st">(n=177)"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>      depth_category <span class="sc">==</span> <span class="st">"Lower"</span> <span class="sc">~</span> <span class="st">"Mesopelagic</span><span class="sc">\n</span><span class="st">(n=52)"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(depth_category)  <span class="co"># fallback</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_category =</span> <span class="fu">factor</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      depth_category,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Epipelagic</span><span class="sc">\n</span><span class="st">(n=177)"</span>, <span class="st">"Mesopelagic</span><span class="sc">\n</span><span class="st">(n=52)"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cells_prop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 8
# Groups:   depth_category [2]
   filtration seabasin depth_category   depth_range shape criteria     n    prop
   &lt;chr&gt;      &lt;chr&gt;    &lt;fct&gt;            &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 Yes        Amundsen "Epipelagic\n(n… Upper (10-… Rods  Yes         20 0.113  
 2 Yes        Amundsen "Epipelagic\n(n… Upper (10-… Vibr… Yes         20 0.113  
 3 Yes        Amundsen "Epipelagic\n(n… Upper (10-… Cocci Yes          8 0.0452 
 4 Yes        Amundsen "Epipelagic\n(n… Upper (10-… Spir… Yes          5 0.0282 
 5 Yes        Amundsen "Epipelagic\n(n… Upper (10-… Spir… Yes          1 0.00565
 6 Yes        Amundsen "Mesopelagic\n(… Lower (274… Rods  Yes          6 0.115  
 7 Yes        Amundsen "Mesopelagic\n(… Lower (274… Vibr… Yes          2 0.0385 
 8 Yes        Amundsen "Mesopelagic\n(… Lower (274… Cocci Yes          2 0.0385 
 9 Yes        Amundsen "Mesopelagic\n(… Lower (274… Spir… Yes          1 0.0192 
10 Yes        Makarov  "Epipelagic\n(n… Upper (10-… Rods  Yes         40 0.226  
# ℹ 14 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Set the levels for Shape to the desired order</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>cells_prop<span class="sc">$</span>shape <span class="ot">&lt;-</span> <span class="fu">factor</span>(cells_prop<span class="sc">$</span>shape,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Rods"</span>, <span class="st">"Cocci"</span>, <span class="st">"Vibrioid"</span>, <span class="st">"Spirals"</span>, <span class="st">"Spirochetes"</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">##Proportion of cells</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>cells_shape_prop <span class="ot">&lt;-</span> cells_prop <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(depth_category, shape) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(depth_category) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shapeProp =</span> <span class="fu">round</span>((total <span class="sc">/</span> <span class="fu">sum</span>(total)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cells_shape_prop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   depth_category [2]
   depth_category        shape       total shapeProp
   &lt;fct&gt;                 &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 "Epipelagic\n(n=177)" Rods           75      42.4
 2 "Epipelagic\n(n=177)" Cocci          58      32.8
 3 "Epipelagic\n(n=177)" Vibrioid       37      20.9
 4 "Epipelagic\n(n=177)" Spirals         6       3.4
 5 "Epipelagic\n(n=177)" Spirochetes     1       0.6
 6 "Mesopelagic\n(n=52)" Rods           30      57.7
 7 "Mesopelagic\n(n=52)" Cocci          12      23.1
 8 "Mesopelagic\n(n=52)" Vibrioid        6      11.5
 9 "Mesopelagic\n(n=52)" Spirals         2       3.8
10 "Mesopelagic\n(n=52)" Spirochetes     2       3.8</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Gradient proportion</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cells_shape_prop <span class="ot">&lt;-</span> cells_shape_prop <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label_color =</span> <span class="fu">ifelse</span>(shapeProp <span class="sc">&gt;</span> <span class="dv">23</span>, <span class="st">"white"</span>, <span class="st">"black"</span>))  <span class="co"># Black and white colors were set to see the % numbers on contasts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Gradient plot of cell shapes</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Fig4a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cells_shape_prop,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> depth_category, <span class="at">y =</span> shape, <span class="at">fill =</span> shapeProp)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(shapeProp, <span class="dv">1</span>), <span class="st">"%"</span>), <span class="at">color =</span> label_color), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="co"># Add percentages</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span>  <span class="co"># This tells ggplot: "label_color already is the final color"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"cividis"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Proportion (%)"</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Proportion (%)"</span>, <span class="at">x =</span> <span class="st">"Depth"</span>, <span class="at">y =</span> <span class="st">"Cell shape"</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"sans"</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"Black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"Black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="cn">NA</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.03</span>),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"lines"</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>Fig4a</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="do">##save in figures folder</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"Fig4a.png"</span>,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> Fig4a,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"figures"</span>,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">28</span>,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">22</span>,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"cm"</span>,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">400</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-4a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sas21-sem_files/figure-html/fig-4a-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Proportion of cell shape proprotion between epipelgiac and mesopelagic layers
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sem-image-showing-morphological-features" class="level1">
<h1>SEM image showing morphological features</h1>
<p><a href="#fig-4b" class="quarto-xref">Figure&nbsp;2</a> shows the different morphological features of Arctic prokaryotes seen in scanning electron microscopy</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">##upload the SEM image</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>SEM <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"./figures/Fig4b.png"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Convert to grob for ggplot</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>g_img <span class="ot">&lt;-</span> <span class="fu">rasterGrob</span>(SEM, <span class="at">interpolate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">##Wrap in a ggplot panel</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>Fig4b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(g_img) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="do">##Show the figure</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>Fig4b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-4b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sas21-sem_files/figure-html/fig-4b-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Scanning electron micrographs shows the different morphological features of Arctic prokaryotes
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="statistical-tests-specific-to-cell-shape-between-depths" class="level1">
<h1>Statistical tests: specific to cell shape between depths</h1>
<p>Cell counts for each shape were grouped into epipelagic (upper) and mesopelagic (lower) layers, and the proportion of each cell shape was calculated within each depth category.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">##To test if there is significant difference between overall cell shape proportion between depths</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">##Check normality of data in cell shape proprotion</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Is Proportion different between Epipelagic and Mesopelagic overall, pooling all shapes together?</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">##Read a specific sheet by name</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>shape_depth <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"./data/rawdata.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"seabasin_depth_proportion"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="do">##Shapiro Wilk test based on depth</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="do">##1.Null hypothesis(H0): data follows normal distribution</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="do">##2.Alternate hypothesis(H1): data does not follow normal distribution</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>normality_depth <span class="ot">&lt;-</span> shape_depth <span class="sc">|&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(depth) <span class="sc">|&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">shapiro_p =</span> <span class="cf">if</span> (<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">3</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">shapiro.test</span>(proportion)<span class="sc">$</span>p.value</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>              <span class="cn">NA</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(normality_depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  depth           n shapiro_p
  &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt;
1 Epipelagic     42  5.73e-11
2 Mesopelagic    24  1.18e- 6</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">##p-value &lt; 0.05, Reject Null hypothesis: Data is not normally distributed</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply non parametric test</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall Mann–Whitney test</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>wilcox_depth <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(proportion <span class="sc">~</span> depth,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> shape_depth,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">exact =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test

data:  proportion by depth
W = 220, p-value = 0.0001277
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">##There is significant difference in overall cell shape proportions</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">##check if there is any siginficant difference in a specific shape between two depths</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Check Shapiro–Wilk tests for normality</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>normality_shape_depth <span class="ot">&lt;-</span> shape_depth <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(shape, depth) <span class="sc">|&gt;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n      =</span> <span class="fu">n</span>(),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">shapiro_p =</span> <span class="cf">if</span> (n <span class="sc">&gt;=</span> <span class="dv">3</span>) {</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">shapiro.test</span>(proportion)<span class="sc">$</span>p.value</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(normality_shape_depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   shape      depth           n   shapiro_p
   &lt;chr&gt;      &lt;chr&gt;       &lt;int&gt;       &lt;dbl&gt;
 1 Rod        Epipelagic     13  0.00000818
 2 Rod        Mesopelagic    11  0.00221   
 3 Spherical  Epipelagic     12  0.000103  
 4 Spherical  Mesopelagic     5  0.00327   
 5 Spiral     Epipelagic      4  0.0239    
 6 Spiral     Mesopelagic     2 NA         
 7 Spirochete Epipelagic      1 NA         
 8 Spirochete Mesopelagic     1 NA         
 9 Vibrioid   Epipelagic     12  0.0572    
10 Vibrioid   Mesopelagic     5  0.000131  </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Based on normality test, the data is non-normal (p&lt;0.05), so test with non parametric test</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">##Wilcoxon per shape: Epipelagic vs Mesopelagic</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>wilcox_shape_depth <span class="ot">&lt;-</span> shape_depth <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(shape) <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_ep =</span> <span class="fu">sum</span>(depth <span class="sc">==</span> <span class="st">"Epipelagic"</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_ms =</span> <span class="fu">sum</span>(depth <span class="sc">==</span> <span class="st">"Mesopelagic"</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="cf">if</span> (n_ep <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;&amp;</span> n_ms <span class="sc">&gt;=</span> <span class="dv">3</span>) {</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">wilcox.test</span>(</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        proportion <span class="sc">~</span> depth,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">cur_data_all</span>(),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">exact   =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">$</span>p.value</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_adj =</span> <span class="fu">p.adjust</span>(p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>))</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_shape_depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  shape       n_ep  n_ms p_value  p_adj
  &lt;chr&gt;      &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 Rod           13    11  0.0836  0.251
2 Spherical     12     5  0.105   0.314
3 Spiral         4     2 NA      NA    
4 Spirochete     1     1 NA      NA    
5 Vibrioid      12     5  0.0525  0.157</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">##p-adjusted values shows that there is no siginficant difference between rods, spherical and vibrioid between epipelagic and mesopelagic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="statistical-tests-specific-to-cell-shape-between-seabasins" class="level1">
<h1>Statistical tests: specific to cell shape between seabasins</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">##For seabasin-Normality test</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>normality_test_seabasin <span class="ot">&lt;-</span> shape_depth <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(seabasin, depth) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">shapiro_p =</span> <span class="cf">if</span> (<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">3</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">shapiro.test</span>(proportion)<span class="sc">$</span>p.value</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>              <span class="cn">NA</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(normality_test_seabasin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  seabasin depth           n shapiro_p
  &lt;chr&gt;    &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt;
1 Amundsen Epipelagic     18 0.0272   
2 Amundsen Mesopelagic     8 0.000165 
3 Makarov  Epipelagic     11 0.0000153
4 Makarov  Mesopelagic    10 0.00306  
5 Nansen   Epipelagic     13 0.103    
6 Nansen   Mesopelagic     6 0.000271 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">##In most of the cases, p &lt; 0.05, so non-normal</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">##So, KW test done-for comparing two or more independent samples-3 seabasins here</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">##OverallKruskall wallis test (ignoring Shape)</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>kw_seabasin <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(proportion <span class="sc">~</span> seabasin, <span class="at">data =</span> shape_depth)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kw_seabasin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  proportion by seabasin
Kruskal-Wallis chi-squared = 0.52448, df = 2, p-value = 0.7693</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">##No significant difference found</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="chi-square-test-finding-association-of-morphological-features-between-epipelagic-and-mesopelagic-layers" class="level1">
<h1>Chi-square test: Finding association of morphological features between epipelagic and mesopelagic layers</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Chi square test on morphological features</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">##Read a specific sheet by name</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>morph_features <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"./data/rawdata.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"features"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(morph_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 120
Columns: 6
$ seabasin        &lt;chr&gt; "Amundsen", "Amundsen", "Amundsen", "Amundsen", "Makar…
$ depth           &lt;chr&gt; "Epipelagic", "Epipelagic", "Mesopelagic", "Mesopelagi…
$ feature_acronym &lt;chr&gt; "CC", "CC", "CC", "CC", "CC", "CC", "CC", "CC", "CC", …
$ features        &lt;chr&gt; "Cell connections", "Cell connections", "Cell connecti…
$ criteria        &lt;chr&gt; "Yes", "No", "Yes", "No", "Yes", "No", "Yes", "No", "Y…
$ counts          &lt;dbl&gt; 0, 54, 2, 9, 10, 67, 0, 25, 3, 43, 0, 14, 27, 27, 3, 8…</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Convert columns to factors</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>morph_features<span class="sc">$</span>seabasin <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(morph_features<span class="sc">$</span>seabasin)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>morph_features<span class="sc">$</span>depth <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(morph_features<span class="sc">$</span>depth)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>morph_features<span class="sc">$</span>features <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(morph_features<span class="sc">$</span>features)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>morph_features<span class="sc">$</span>criteria <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(morph_features<span class="sc">$</span>criteria)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Chi-square test function for depth and features</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>perform_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(df, feature_name) {</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Filter data for the specific feature</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  feature_df <span class="ot">&lt;-</span> morph_features <span class="sc">%&gt;%</span> <span class="fu">filter</span>(features <span class="sc">==</span> feature_name)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Create a 2x2 contingency table using depth and criteria</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(counts <span class="sc">~</span> depth <span class="sc">+</span> criteria, <span class="at">data =</span> feature_df)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Contingency Table for Feature:"</span>, feature_name, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tbl)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Check if the table is 2x2</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(tbl) <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;&amp;</span> <span class="fu">ncol</span>(tbl) <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Perform chi-square test without correction</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    chisq_result <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(tbl, <span class="at">correct =</span> <span class="cn">FALSE</span>))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Expected Frequencies for Feature:"</span>, feature_name, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(chisq_result<span class="sc">$</span>expected)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Decision logic for test selection</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(chisq_result<span class="sc">$</span>expected <span class="sc">&lt;=</span> <span class="dv">5</span>)) {</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>      <span class="do">##Fisher's Exact Test: Used when any expected frequency is &lt;= 5</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>      <span class="do">##Provides exact p-values and is preferred for small expected frequencies</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Expected frequency &lt;= 5, using Fisher's Exact Test...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>      fisher_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(tbl)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(fisher_result)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>      <span class="do">##Chi-Square Test without correction: Applied when all expected frequencies &gt; 5</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>      <span class="do">##Reliable and straightforward when expected counts are sufficient</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Expected frequency &gt; 5, using standard Chi-Square Test...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>      chisq_result <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(tbl, <span class="at">correct =</span> <span class="cn">FALSE</span>))</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(chisq_result)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Invalid 2x2 table for feature:"</span>, feature_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="chi-square-test-results" class="level1">
<h1>Chi-square test results</h1>
<p>All ten morphological features observed in Arctic prokaryotes were evaluated using chi-square tests to examine their association with epipelagic and mesopelagic depth layers. For this analysis, data from both depth layers were combined and compared.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Unique features list</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>distinct_features <span class="ot">&lt;-</span> <span class="fu">unique</span>(morph_features<span class="sc">$</span>features)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Print overall results first</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=================== Overall Chi-Square Tests ===================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=================== Overall Chi-Square Tests ===================</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (features <span class="cf">in</span> distinct_features) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Feature:"</span>, features, <span class="st">"===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">perform_chisq_test</span>(morph_features, features)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Feature: Cell connections ===
Contingency Table for Feature: Cell connections :
             criteria
depth          No Yes
  Epipelagic  164  13
  Mesopelagic  48   2

Expected Frequencies for Feature: Cell connections :
             criteria
depth                No       Yes
  Epipelagic  165.30396 11.696035
  Mesopelagic  46.69604  3.303965

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 0.5317
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.05584882 2.45382787
sample estimates:
odds ratio 
 0.5268776 


=== Feature: Tubules like + Extracellular polymeric substances ===
Contingency Table for Feature: Tubules like + Extracellular polymeric substances :
             criteria
depth          No Yes
  Epipelagic   73 104
  Mesopelagic  34  18

Expected Frequencies for Feature: Tubules like + Extracellular polymeric substances :
             criteria
depth               No      Yes
  Epipelagic  82.70306 94.29694
  Mesopelagic 24.29694 27.70306

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 9.4103, df = 1, p-value = 0.002158


=== Feature: Tubules like structures + Vesicle like structures ===
Contingency Table for Feature: Tubules like structures + Vesicle like structures :
             criteria
depth          No Yes
  Epipelagic  158  19
  Mesopelagic  46   6

Expected Frequencies for Feature: Tubules like structures + Vesicle like structures :
             criteria
depth                No       Yes
  Epipelagic  157.67686 19.323144
  Mesopelagic  46.32314  5.676856

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 0.026715, df = 1, p-value = 0.8702


=== Feature: Vesicle like structures ===
Contingency Table for Feature: Vesicle like structures :
             criteria
depth          No Yes
  Epipelagic  145  32
  Mesopelagic  32  20

Expected Frequencies for Feature: Vesicle like structures :
             criteria
depth                No      Yes
  Epipelagic  136.80786 40.19214
  Mesopelagic  40.19214 11.80786

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 9.5137, df = 1, p-value = 0.002039


=== Feature: Extracellular polymeric substances ===
Contingency Table for Feature: Extracellular polymeric substances :
             criteria
depth          No Yes
  Epipelagic  131  46
  Mesopelagic  43   9

Expected Frequencies for Feature: Extracellular polymeric substances :
             criteria
depth                No      Yes
  Epipelagic  134.48908 42.51092
  Mesopelagic  39.51092 12.48908

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 1.6597, df = 1, p-value = 0.1976


=== Feature: Pili like structures ===
Contingency Table for Feature: Pili like structures :
             criteria
depth          No Yes
  Epipelagic  111  66
  Mesopelagic  40  12

Expected Frequencies for Feature: Pili like structures :
             criteria
depth                No      Yes
  Epipelagic  116.71179 60.28821
  Mesopelagic  34.28821 17.71179

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 3.6141, df = 1, p-value = 0.05729


=== Feature: Membrane blebbing ===
Contingency Table for Feature: Membrane blebbing :
             criteria
depth         No Yes
  Epipelagic  97  80
  Mesopelagic 33  19

Expected Frequencies for Feature: Membrane blebbing :
             criteria
depth                No      Yes
  Epipelagic  100.48035 76.51965
  Mesopelagic  29.51965 22.48035

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 1.228, df = 1, p-value = 0.2678


=== Feature: Flagella like ===
Contingency Table for Feature: Flagella like :
             criteria
depth          No Yes
  Epipelagic  177   0
  Mesopelagic  50   2

Expected Frequencies for Feature: Flagella like :
             criteria
depth                No       Yes
  Epipelagic  175.45415 1.5458515
  Mesopelagic  51.54585 0.4541485

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 0.05079
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.6449698       Inf
sample estimates:
odds ratio 
       Inf 


=== Feature: Cell division ===
Contingency Table for Feature: Cell division :
             criteria
depth          No Yes
  Epipelagic  172   5
  Mesopelagic  51   1

Expected Frequencies for Feature: Cell division :
             criteria
depth                No      Yes
  Epipelagic  172.36245 4.637555
  Mesopelagic  50.63755 1.362445

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 1
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.01399436 6.23742706
sample estimates:
odds ratio 
 0.6755646 


=== Feature: Tubules like ===
Contingency Table for Feature: Tubules like :
             criteria
depth          No Yes
  Epipelagic  134  43
  Mesopelagic  49   3

Expected Frequencies for Feature: Tubules like :
             criteria
depth                No      Yes
  Epipelagic  141.44541 35.55459
  Mesopelagic  41.55459 10.44541

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 8.5921, df = 1, p-value = 0.003376</code></pre>
</div>
</div>
</section>
<section id="chi-square-test-results-seabasin-specific-analysis" class="level1">
<h1>Chi-square test results: seabasin-specific analysis</h1>
<p>This analysis evaluates whether morphological features are significantly associated with individual seabasins (Amundsen, Makarov and Nansen) using seabasin-specific chi-square tests. The results will appear as ten chi-square analysis under each seabasin.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Print seabasin-specific results</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=================== Site-Specific Chi-Square Tests ===================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=================== Site-Specific Chi-Square Tests ===================</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sb <span class="cf">in</span> <span class="fu">unique</span>(morph_features<span class="sc">$</span>seabasin)) {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  seabsin_data <span class="ot">&lt;-</span> morph_features <span class="sc">%&gt;%</span> <span class="fu">filter</span>(seabasin <span class="sc">==</span> sb)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">seabasin:"</span>, sb, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (feat <span class="cf">in</span> distinct_features) {</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Feature:"</span>, feat, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">perform_chisq_test</span>(seabasin_data, feat)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
seabasin: Amundsen 

Feature: Cell connections 
Contingency Table for Feature: Cell connections :
             criteria
depth          No Yes
  Epipelagic  164  13
  Mesopelagic  48   2

Expected Frequencies for Feature: Cell connections :
             criteria
depth                No       Yes
  Epipelagic  165.30396 11.696035
  Mesopelagic  46.69604  3.303965

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 0.5317
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.05584882 2.45382787
sample estimates:
odds ratio 
 0.5268776 


Feature: Tubules like + Extracellular polymeric substances 
Contingency Table for Feature: Tubules like + Extracellular polymeric substances :
             criteria
depth          No Yes
  Epipelagic   73 104
  Mesopelagic  34  18

Expected Frequencies for Feature: Tubules like + Extracellular polymeric substances :
             criteria
depth               No      Yes
  Epipelagic  82.70306 94.29694
  Mesopelagic 24.29694 27.70306

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 9.4103, df = 1, p-value = 0.002158


Feature: Tubules like structures + Vesicle like structures 
Contingency Table for Feature: Tubules like structures + Vesicle like structures :
             criteria
depth          No Yes
  Epipelagic  158  19
  Mesopelagic  46   6

Expected Frequencies for Feature: Tubules like structures + Vesicle like structures :
             criteria
depth                No       Yes
  Epipelagic  157.67686 19.323144
  Mesopelagic  46.32314  5.676856

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 0.026715, df = 1, p-value = 0.8702


Feature: Vesicle like structures 
Contingency Table for Feature: Vesicle like structures :
             criteria
depth          No Yes
  Epipelagic  145  32
  Mesopelagic  32  20

Expected Frequencies for Feature: Vesicle like structures :
             criteria
depth                No      Yes
  Epipelagic  136.80786 40.19214
  Mesopelagic  40.19214 11.80786

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 9.5137, df = 1, p-value = 0.002039


Feature: Extracellular polymeric substances 
Contingency Table for Feature: Extracellular polymeric substances :
             criteria
depth          No Yes
  Epipelagic  131  46
  Mesopelagic  43   9

Expected Frequencies for Feature: Extracellular polymeric substances :
             criteria
depth                No      Yes
  Epipelagic  134.48908 42.51092
  Mesopelagic  39.51092 12.48908

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 1.6597, df = 1, p-value = 0.1976


Feature: Pili like structures 
Contingency Table for Feature: Pili like structures :
             criteria
depth          No Yes
  Epipelagic  111  66
  Mesopelagic  40  12

Expected Frequencies for Feature: Pili like structures :
             criteria
depth                No      Yes
  Epipelagic  116.71179 60.28821
  Mesopelagic  34.28821 17.71179

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 3.6141, df = 1, p-value = 0.05729


Feature: Membrane blebbing 
Contingency Table for Feature: Membrane blebbing :
             criteria
depth         No Yes
  Epipelagic  97  80
  Mesopelagic 33  19

Expected Frequencies for Feature: Membrane blebbing :
             criteria
depth                No      Yes
  Epipelagic  100.48035 76.51965
  Mesopelagic  29.51965 22.48035

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 1.228, df = 1, p-value = 0.2678


Feature: Flagella like 
Contingency Table for Feature: Flagella like :
             criteria
depth          No Yes
  Epipelagic  177   0
  Mesopelagic  50   2

Expected Frequencies for Feature: Flagella like :
             criteria
depth                No       Yes
  Epipelagic  175.45415 1.5458515
  Mesopelagic  51.54585 0.4541485

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 0.05079
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.6449698       Inf
sample estimates:
odds ratio 
       Inf 


Feature: Cell division 
Contingency Table for Feature: Cell division :
             criteria
depth          No Yes
  Epipelagic  172   5
  Mesopelagic  51   1

Expected Frequencies for Feature: Cell division :
             criteria
depth                No      Yes
  Epipelagic  172.36245 4.637555
  Mesopelagic  50.63755 1.362445

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 1
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.01399436 6.23742706
sample estimates:
odds ratio 
 0.6755646 


Feature: Tubules like 
Contingency Table for Feature: Tubules like :
             criteria
depth          No Yes
  Epipelagic  134  43
  Mesopelagic  49   3

Expected Frequencies for Feature: Tubules like :
             criteria
depth                No      Yes
  Epipelagic  141.44541 35.55459
  Mesopelagic  41.55459 10.44541

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 8.5921, df = 1, p-value = 0.003376


seabasin: Makarov 

Feature: Cell connections 
Contingency Table for Feature: Cell connections :
             criteria
depth          No Yes
  Epipelagic  164  13
  Mesopelagic  48   2

Expected Frequencies for Feature: Cell connections :
             criteria
depth                No       Yes
  Epipelagic  165.30396 11.696035
  Mesopelagic  46.69604  3.303965

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 0.5317
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.05584882 2.45382787
sample estimates:
odds ratio 
 0.5268776 


Feature: Tubules like + Extracellular polymeric substances 
Contingency Table for Feature: Tubules like + Extracellular polymeric substances :
             criteria
depth          No Yes
  Epipelagic   73 104
  Mesopelagic  34  18

Expected Frequencies for Feature: Tubules like + Extracellular polymeric substances :
             criteria
depth               No      Yes
  Epipelagic  82.70306 94.29694
  Mesopelagic 24.29694 27.70306

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 9.4103, df = 1, p-value = 0.002158


Feature: Tubules like structures + Vesicle like structures 
Contingency Table for Feature: Tubules like structures + Vesicle like structures :
             criteria
depth          No Yes
  Epipelagic  158  19
  Mesopelagic  46   6

Expected Frequencies for Feature: Tubules like structures + Vesicle like structures :
             criteria
depth                No       Yes
  Epipelagic  157.67686 19.323144
  Mesopelagic  46.32314  5.676856

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 0.026715, df = 1, p-value = 0.8702


Feature: Vesicle like structures 
Contingency Table for Feature: Vesicle like structures :
             criteria
depth          No Yes
  Epipelagic  145  32
  Mesopelagic  32  20

Expected Frequencies for Feature: Vesicle like structures :
             criteria
depth                No      Yes
  Epipelagic  136.80786 40.19214
  Mesopelagic  40.19214 11.80786

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 9.5137, df = 1, p-value = 0.002039


Feature: Extracellular polymeric substances 
Contingency Table for Feature: Extracellular polymeric substances :
             criteria
depth          No Yes
  Epipelagic  131  46
  Mesopelagic  43   9

Expected Frequencies for Feature: Extracellular polymeric substances :
             criteria
depth                No      Yes
  Epipelagic  134.48908 42.51092
  Mesopelagic  39.51092 12.48908

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 1.6597, df = 1, p-value = 0.1976


Feature: Pili like structures 
Contingency Table for Feature: Pili like structures :
             criteria
depth          No Yes
  Epipelagic  111  66
  Mesopelagic  40  12

Expected Frequencies for Feature: Pili like structures :
             criteria
depth                No      Yes
  Epipelagic  116.71179 60.28821
  Mesopelagic  34.28821 17.71179

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 3.6141, df = 1, p-value = 0.05729


Feature: Membrane blebbing 
Contingency Table for Feature: Membrane blebbing :
             criteria
depth         No Yes
  Epipelagic  97  80
  Mesopelagic 33  19

Expected Frequencies for Feature: Membrane blebbing :
             criteria
depth                No      Yes
  Epipelagic  100.48035 76.51965
  Mesopelagic  29.51965 22.48035

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 1.228, df = 1, p-value = 0.2678


Feature: Flagella like 
Contingency Table for Feature: Flagella like :
             criteria
depth          No Yes
  Epipelagic  177   0
  Mesopelagic  50   2

Expected Frequencies for Feature: Flagella like :
             criteria
depth                No       Yes
  Epipelagic  175.45415 1.5458515
  Mesopelagic  51.54585 0.4541485

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 0.05079
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.6449698       Inf
sample estimates:
odds ratio 
       Inf 


Feature: Cell division 
Contingency Table for Feature: Cell division :
             criteria
depth          No Yes
  Epipelagic  172   5
  Mesopelagic  51   1

Expected Frequencies for Feature: Cell division :
             criteria
depth                No      Yes
  Epipelagic  172.36245 4.637555
  Mesopelagic  50.63755 1.362445

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 1
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.01399436 6.23742706
sample estimates:
odds ratio 
 0.6755646 


Feature: Tubules like 
Contingency Table for Feature: Tubules like :
             criteria
depth          No Yes
  Epipelagic  134  43
  Mesopelagic  49   3

Expected Frequencies for Feature: Tubules like :
             criteria
depth                No      Yes
  Epipelagic  141.44541 35.55459
  Mesopelagic  41.55459 10.44541

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 8.5921, df = 1, p-value = 0.003376


seabasin: Nansen 

Feature: Cell connections 
Contingency Table for Feature: Cell connections :
             criteria
depth          No Yes
  Epipelagic  164  13
  Mesopelagic  48   2

Expected Frequencies for Feature: Cell connections :
             criteria
depth                No       Yes
  Epipelagic  165.30396 11.696035
  Mesopelagic  46.69604  3.303965

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 0.5317
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.05584882 2.45382787
sample estimates:
odds ratio 
 0.5268776 


Feature: Tubules like + Extracellular polymeric substances 
Contingency Table for Feature: Tubules like + Extracellular polymeric substances :
             criteria
depth          No Yes
  Epipelagic   73 104
  Mesopelagic  34  18

Expected Frequencies for Feature: Tubules like + Extracellular polymeric substances :
             criteria
depth               No      Yes
  Epipelagic  82.70306 94.29694
  Mesopelagic 24.29694 27.70306

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 9.4103, df = 1, p-value = 0.002158


Feature: Tubules like structures + Vesicle like structures 
Contingency Table for Feature: Tubules like structures + Vesicle like structures :
             criteria
depth          No Yes
  Epipelagic  158  19
  Mesopelagic  46   6

Expected Frequencies for Feature: Tubules like structures + Vesicle like structures :
             criteria
depth                No       Yes
  Epipelagic  157.67686 19.323144
  Mesopelagic  46.32314  5.676856

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 0.026715, df = 1, p-value = 0.8702


Feature: Vesicle like structures 
Contingency Table for Feature: Vesicle like structures :
             criteria
depth          No Yes
  Epipelagic  145  32
  Mesopelagic  32  20

Expected Frequencies for Feature: Vesicle like structures :
             criteria
depth                No      Yes
  Epipelagic  136.80786 40.19214
  Mesopelagic  40.19214 11.80786

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 9.5137, df = 1, p-value = 0.002039


Feature: Extracellular polymeric substances 
Contingency Table for Feature: Extracellular polymeric substances :
             criteria
depth          No Yes
  Epipelagic  131  46
  Mesopelagic  43   9

Expected Frequencies for Feature: Extracellular polymeric substances :
             criteria
depth                No      Yes
  Epipelagic  134.48908 42.51092
  Mesopelagic  39.51092 12.48908

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 1.6597, df = 1, p-value = 0.1976


Feature: Pili like structures 
Contingency Table for Feature: Pili like structures :
             criteria
depth          No Yes
  Epipelagic  111  66
  Mesopelagic  40  12

Expected Frequencies for Feature: Pili like structures :
             criteria
depth                No      Yes
  Epipelagic  116.71179 60.28821
  Mesopelagic  34.28821 17.71179

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 3.6141, df = 1, p-value = 0.05729


Feature: Membrane blebbing 
Contingency Table for Feature: Membrane blebbing :
             criteria
depth         No Yes
  Epipelagic  97  80
  Mesopelagic 33  19

Expected Frequencies for Feature: Membrane blebbing :
             criteria
depth                No      Yes
  Epipelagic  100.48035 76.51965
  Mesopelagic  29.51965 22.48035

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 1.228, df = 1, p-value = 0.2678


Feature: Flagella like 
Contingency Table for Feature: Flagella like :
             criteria
depth          No Yes
  Epipelagic  177   0
  Mesopelagic  50   2

Expected Frequencies for Feature: Flagella like :
             criteria
depth                No       Yes
  Epipelagic  175.45415 1.5458515
  Mesopelagic  51.54585 0.4541485

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 0.05079
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.6449698       Inf
sample estimates:
odds ratio 
       Inf 


Feature: Cell division 
Contingency Table for Feature: Cell division :
             criteria
depth          No Yes
  Epipelagic  172   5
  Mesopelagic  51   1

Expected Frequencies for Feature: Cell division :
             criteria
depth                No      Yes
  Epipelagic  172.36245 4.637555
  Mesopelagic  50.63755 1.362445

Expected frequency &lt;= 5, using Fisher's Exact Test...

    Fisher's Exact Test for Count Data

data:  tbl
p-value = 1
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.01399436 6.23742706
sample estimates:
odds ratio 
 0.6755646 


Feature: Tubules like 
Contingency Table for Feature: Tubules like :
             criteria
depth          No Yes
  Epipelagic  134  43
  Mesopelagic  49   3

Expected Frequencies for Feature: Tubules like :
             criteria
depth                No      Yes
  Epipelagic  141.44541 35.55459
  Mesopelagic  41.55459 10.44541

Expected frequency &gt; 5, using standard Chi-Square Test...

    Pearson's Chi-squared test

data:  tbl
X-squared = 8.5921, df = 1, p-value = 0.003376</code></pre>
</div>
</div>
</section>
<section id="chi-square-table" class="level1">
<h1>Chi-square table</h1>
<p><a href="#fig-4c" class="quarto-xref">Figure&nbsp;3</a> shows results from the chi-square test analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Create Chi square-table</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>significant_features <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Seabasin =</span> <span class="fu">c</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Amundsen +</span><span class="sc">\n</span><span class="st">Makarov +</span><span class="sc">\n</span><span class="st">Nansen (n = 229)"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Amundsen (n = 65)"</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Makarov (n = 104)"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nansen ( n= 60)"</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Morphological features</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"TL-EPS"</span>, <span class="st">"VL"</span>, <span class="st">"TL"</span>, <span class="st">"VL"</span>, <span class="st">"TL-EPS"</span>, <span class="st">"PL"</span>, <span class="st">"TL"</span>, <span class="st">"EPS"</span>),</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Chi- square test (p-value)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"9.4 (0.002)"</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"9.5 (0.001)"</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"8.6 (0.003)"</span>,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt; 0.001"</span>,</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"12.7 (&lt; 0.001)"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"16.2 (&lt; 0.001"</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"11.5 (&lt;0.001)"</span>,</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4.5 (0.03)"</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Odds ratio</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2.7 (E/M)"</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2.8 (M/E)"</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5.3 (E/M)"</span>,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"28.5 (M/E)"</span>,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5.1 (E/M)"</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"10.1 (E/M"</span>,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"7.4 (E/M)"</span>,</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5.0 (E/M)"</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="do">##Set column names</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(significant_features) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Seabasin"</span>, <span class="st">"Features"</span>, <span class="st">"Chi-square (p-value)"</span>, <span class="st">"Odds ratio"</span>)</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="do">##Create custom theme with sans font and size 7</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>nm_style <span class="ot">&lt;-</span> <span class="fu">ttheme</span>(</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">base_size =</span> <span class="dv">7</span>,</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">colnames.style =</span> <span class="fu">colnames_style</span>(</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontfamily =</span> <span class="st">"sans"</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">tbody.style =</span> <span class="fu">tbody_style</span>(</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">face =</span> <span class="st">"plain"</span>,</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">6.5</span>,</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontfamily =</span> <span class="st">"sans"</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a><span class="do">##Make the table</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>Fig4c_table <span class="ot">&lt;-</span> <span class="fu">ggtexttable</span>(significant_features, <span class="at">rows =</span> <span class="cn">NULL</span>, <span class="at">theme =</span> nm_style)</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>Fig4c_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-4c" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sas21-sem_files/figure-html/fig-4c-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Chi-square test results showing the association of morphological features with different depth layers of Central Arctic Ocean
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="elemental-analysis-of-arctic-prokaryotes-using-sem-edx" class="level1">
<h1>Elemental analysis of Arctic prokaryotes using SEM-EDX</h1>
<p><a href="#fig-4d" class="quarto-xref">Figure&nbsp;4</a> shows the elemental ratio of Arctic prokaryotes</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Fig.4d: Read a specific sheet by name</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>edx_ratio_cell <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"./data/rawdata.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"edx_cell_mol_ratio"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Modify Depth labels</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>edx_ratio_cell<span class="sc">$</span>depthID <span class="ot">&lt;-</span> <span class="fu">factor</span>(edx_ratio_cell<span class="sc">$</span>depthID,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Epipelagic"</span>, <span class="st">"Mesopelagic"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Use pivot_longer to reshape the data</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>edx_ratio_cell <span class="ot">&lt;-</span> edx_ratio_cell <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"C_N"</span>, <span class="st">"C_P"</span>, <span class="st">"N_P"</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"mol_ratio"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(edx_ratio_cell)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 294 × 6
   depthID        C     N     P mol_ratio  value
   &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
 1 Epipelagic  90.9  8.25 0.797 C_N        11.0 
 2 Epipelagic  90.9  8.25 0.797 C_P       114.  
 3 Epipelagic  90.9  8.25 0.797 N_P        10.4 
 4 Epipelagic  88.2 11.1  0.717 C_N         7.94
 5 Epipelagic  88.2 11.1  0.717 C_P       123.  
 6 Epipelagic  88.2 11.1  0.717 N_P        15.5 
 7 Epipelagic  93.0  5.10 0.384 C_N        18.2 
 8 Epipelagic  93.0  5.10 0.384 C_P       242.  
 9 Epipelagic  93.0  5.10 0.384 N_P        13.3 
10 Epipelagic  94.5  6.66 0.368 C_N        14.2 
# ℹ 284 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">##define and remove outliers</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="do">##define the outlier removal function based on IQR</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>remove_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># First quartile (25th percentile)</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Third quartile (75th percentile)</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  IQR_value <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1  <span class="co"># Interquartile range</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the bounds for outliers</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  lower_bound <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_value</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  upper_bound <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_value</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return only values within the bounds, and mark outliers as NA</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  cleaned_data <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data <span class="sc">&gt;=</span> lower_bound <span class="sc">&amp;</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>                           data <span class="sc">&lt;=</span> upper_bound, data, <span class="cn">NA</span>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cleaned_data)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Apply outlier removal by depthID and mol_ratio</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>edx_outliers <span class="ot">&lt;-</span> edx_ratio_cell <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(depthID, mol_ratio) <span class="sc">|&gt;</span>  <span class="co"># Group by depthID and mol_ratio</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_no_outliers =</span> <span class="fu">remove_outliers</span>(value)) <span class="sc">|&gt;</span>  <span class="co"># Apply the outlier removal</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Remove grouping after applying the function</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(edx_outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 294 × 7
   depthID        C     N     P mol_ratio  value value_no_outliers
   &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;             &lt;dbl&gt;
 1 Epipelagic  90.9  8.25 0.797 C_N        11.0              11.0 
 2 Epipelagic  90.9  8.25 0.797 C_P       114.              114.  
 3 Epipelagic  90.9  8.25 0.797 N_P        10.4              10.4 
 4 Epipelagic  88.2 11.1  0.717 C_N         7.94              7.94
 5 Epipelagic  88.2 11.1  0.717 C_P       123.              123.  
 6 Epipelagic  88.2 11.1  0.717 N_P        15.5              15.5 
 7 Epipelagic  93.0  5.10 0.384 C_N        18.2              18.2 
 8 Epipelagic  93.0  5.10 0.384 C_P       242.              242.  
 9 Epipelagic  93.0  5.10 0.384 N_P        13.3              13.3 
10 Epipelagic  94.5  6.66 0.368 C_N        14.2              14.2 
# ℹ 284 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Remove rows where Value_outliers is NA (those were outliers)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>edx_no_outliers <span class="ot">&lt;-</span> edx_outliers <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value_no_outliers))  <span class="co"># Keep only rows without outliers</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(edx_no_outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 239 × 7
   depthID        C     N     P mol_ratio  value value_no_outliers
   &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;             &lt;dbl&gt;
 1 Epipelagic  90.9  8.25 0.797 C_N        11.0              11.0 
 2 Epipelagic  90.9  8.25 0.797 C_P       114.              114.  
 3 Epipelagic  90.9  8.25 0.797 N_P        10.4              10.4 
 4 Epipelagic  88.2 11.1  0.717 C_N         7.94              7.94
 5 Epipelagic  88.2 11.1  0.717 C_P       123.              123.  
 6 Epipelagic  88.2 11.1  0.717 N_P        15.5              15.5 
 7 Epipelagic  93.0  5.10 0.384 C_N        18.2              18.2 
 8 Epipelagic  93.0  5.10 0.384 C_P       242.              242.  
 9 Epipelagic  93.0  5.10 0.384 N_P        13.3              13.3 
10 Epipelagic  94.5  6.66 0.368 C_N        14.2              14.2 
# ℹ 229 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Calcualte summary statistics</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>summary_stats_edx <span class="ot">&lt;-</span> edx_no_outliers <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(depthID, mol_ratio) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> <span class="fu">sd</span> (value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI =</span> <span class="fl">1.96</span> <span class="sc">*</span> SE</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats_edx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  depthID     mol_ratio median     SE     n    CI
  &lt;fct&gt;       &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Epipelagic  C_N         13.3  0.841    48  1.65
2 Epipelagic  C_P        179.  13.1      52 25.6 
3 Epipelagic  N_P         11.1  1.19     53  2.34
4 Mesopelagic C_N         10.8  0.930    30  1.82
5 Mesopelagic C_P        247.  30.2      28 59.2 
6 Mesopelagic N_P         13.9  2.01     28  3.93</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Normality Test (Shapiro-Wilk Test)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>shapiro_test_C_N <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(edx_no_outliers<span class="sc">$</span>value_no_outliers[edx_no_outliers<span class="sc">$</span>mol_ratio <span class="sc">==</span> <span class="st">"C_N"</span>])</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>shapiro_test_C_P <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(edx_no_outliers<span class="sc">$</span>value_no_outliers[edx_no_outliers<span class="sc">$</span>mol_ratio <span class="sc">==</span> <span class="st">"C_P"</span>])</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>shapiro_test_N_P <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(edx_no_outliers<span class="sc">$</span>value_no_outliers[edx_no_outliers<span class="sc">$</span>mol_ratio <span class="sc">==</span> <span class="st">"N_P"</span>])</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="do">##View normality test results</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>shapiro_test_C_N</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  edx_no_outliers$value_no_outliers[edx_no_outliers$mol_ratio == "C_N"]
W = 0.91322, p-value = 5.694e-05</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>shapiro_test_C_P</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  edx_no_outliers$value_no_outliers[edx_no_outliers$mol_ratio == "C_P"]
W = 0.89798, p-value = 1.002e-05</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>shapiro_test_N_P</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  edx_no_outliers$value_no_outliers[edx_no_outliers$mol_ratio == "N_P"]
W = 0.93837, p-value = 0.0007243</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Mann-Whitney U test for each ratio (since data is not normal)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="do">##For C:N ratio</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>mann_whitney_C_N <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(value_no_outliers <span class="sc">~</span> depthID, <span class="at">data =</span> edx_no_outliers[edx_no_outliers<span class="sc">$</span>mol_ratio <span class="sc">==</span> <span class="st">"C_N"</span>, ])</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mann_whitney_C_N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  value_no_outliers by depthID
W = 967, p-value = 0.01075
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For C:P ratio</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>mann_whitney_C_P <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(value_no_outliers <span class="sc">~</span> depthID, <span class="at">data =</span> edx_no_outliers[edx_no_outliers<span class="sc">$</span>mol_ratio <span class="sc">==</span> <span class="st">"C_P"</span>, ])</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mann_whitney_C_P)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  value_no_outliers by depthID
W = 580, p-value = 0.1368
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For N:P ratio</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mann_whitney_N_P <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(value_no_outliers <span class="sc">~</span> depthID, <span class="at">data =</span> edx_no_outliers[edx_no_outliers<span class="sc">$</span>mol_ratio <span class="sc">==</span> <span class="st">"N_P"</span>, ])</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mann_whitney_N_P)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  value_no_outliers by depthID
W = 587, p-value = 0.125
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Compute label positions</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>max_y_per_ratio <span class="ot">&lt;-</span> edx_no_outliers <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mol_ratio) <span class="sc">|&gt;</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_y =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">line_y =</span> max_y <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">##line position</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_y =</span> max_y <span class="sc">*</span> <span class="fl">1.08</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="do">##text slightly above line</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"*"</span>, <span class="st">"n.s."</span>, <span class="st">"n.s."</span>)  <span class="do">##adjust based on your stats</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Plot boxplot for the ratios, faceted by depthID</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>ratio_element <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(edx_no_outliers,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> mol_ratio, <span class="at">y =</span> value, <span class="at">fill =</span> depthID)) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.6</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim =</span> <span class="cn">TRUE</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> depthID),</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(),</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"cividis"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> mol_ratio, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C_N"</span> <span class="ot">=</span> <span class="st">"C/N</span><span class="sc">\n</span><span class="st">(n = 48, 30)"</span>,</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"C_P"</span> <span class="ot">=</span> <span class="st">"C/P</span><span class="sc">\n</span><span class="st">(n = 52, 28)"</span>,</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"N_P"</span> <span class="ot">=</span> <span class="st">"N/P</span><span class="sc">\n</span><span class="st">(n = 53, 28)"</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Elemental ratio"</span>, <span class="at">y =</span> <span class="st">"Molar ratio"</span>, <span class="at">fill =</span> <span class="st">"Depth"</span>) <span class="sc">+</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"sans"</span>),</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="cn">NA</span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"Black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"Black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">7</span></span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a><span class="do">##Adding significaNce lines</span></span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>Fig4d <span class="ot">&lt;-</span> ratio_element <span class="sc">+</span></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> max_y_per_ratio,</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">0.7</span>,</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">1.4</span>,</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> line_y,</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> line_y</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> max_y_per_ratio,</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.0</span>, <span class="at">y =</span> text_y, <span class="at">label =</span> label),</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>Fig4d</span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a><span class="do">##Save the plot</span></span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"Elementalratio.png"</span>,</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"figures"</span>,</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> Fig4d,</span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">100</span>,</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">80</span>,</span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"mm"</span>,</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-4d" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sas21-sem_files/figure-html/fig-4d-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Stiochiometric ratio of different elements in the different depth layers of Central Arctic Ocean
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="wrap-and-combine-figures-in-one-plot" class="level1">
<h1>Wrap and combine figures in one plot</h1>
<p><a href="#fig-4" class="quarto-xref">Figure&nbsp;5</a> shows the combined plots of cell shape, morphological features and elemental composition in Arctic prokaryotes</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Wrap it using patchwork</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>Fig4a_wrap <span class="ot">&lt;-</span> <span class="fu">wrap_elements</span>(Fig4a)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>Fig4b_wrap <span class="ot">&lt;-</span> <span class="fu">wrap_elements</span>(Fig4b)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Assemble top and bottom rows</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>top_row <span class="ot">&lt;-</span> Fig4a_wrap <span class="sc">+</span> Fig4b_wrap <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>bottom_row <span class="ot">&lt;-</span> Fig4c_table <span class="sc">+</span> Fig4d</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="do">##Combine rows with annotation</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>Fig4 <span class="ot">&lt;-</span> top_row <span class="sc">/</span> bottom_row <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'a'</span>,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="st">"sans"</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>                  )))</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>Fig4</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="do">##save in figures folder as png</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename=</span> <span class="st">"Fig4_SEM.png"</span>,</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> Fig4,</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span><span class="st">"figures"</span>,</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">180</span>,</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">185</span>,</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"mm"</span>,</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="do">##save in figures folder as pdf</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename=</span> <span class="st">"Fig4_SEM.pdf"</span>,</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> Fig4,</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span><span class="st">"figures"</span>,</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">180</span>,</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">185</span>,</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"mm"</span>,</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sas21-sem_files/figure-html/fig-4-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Morphology and elemental composition of Arctic prokaryotes analysed by SEM and SEM-EDX
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-morphological-features-in-epipelagic-and-mesopelagic-depth-layers" class="level1">
<h1>Distribution of morphological features in epipelagic and mesopelagic depth layers</h1>
<p><a href="#fig-EFa" class="quarto-xref">Figure&nbsp;6</a> shows the distribution of morphological features in the Arctic prokaryotes uisng heatmap gradient</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Extended Figure: Plotting yes and no category foR morphological features</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="do">##Read a specific sheet by name</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>morph_feat <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"./data/rawdata.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"features"</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(morph_feat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 120
Columns: 6
$ seabasin        &lt;chr&gt; "Amundsen", "Amundsen", "Amundsen", "Amundsen", "Makar…
$ depth           &lt;chr&gt; "Epipelagic", "Epipelagic", "Mesopelagic", "Mesopelagi…
$ feature_acronym &lt;chr&gt; "CC", "CC", "CC", "CC", "CC", "CC", "CC", "CC", "CC", …
$ features        &lt;chr&gt; "Cell connections", "Cell connections", "Cell connecti…
$ criteria        &lt;chr&gt; "Yes", "No", "Yes", "No", "Yes", "No", "Yes", "No", "Y…
$ counts          &lt;dbl&gt; 0, 54, 2, 9, 10, 67, 0, 25, 3, 43, 0, 14, 27, 27, 3, 8…</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Compute proportions for counts</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>morph_feat_proportion <span class="ot">&lt;-</span> morph_feat <span class="sc">|&gt;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(seabasin, depth, feature_acronym) <span class="sc">|&gt;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(counts), <span class="at">proportion =</span> counts <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(morph_feat_proportion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 8
   seabasin depth      feature_acronym features criteria counts total proportion
   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1 Amundsen Epipelagic CC              Cell co… Yes           0    54       0   
 2 Amundsen Epipelagic CC              Cell co… No           54    54     100   
 3 Amundsen Mesopelag… CC              Cell co… Yes           2    11      18.2 
 4 Amundsen Mesopelag… CC              Cell co… No            9    11      81.8 
 5 Makarov  Epipelagic CC              Cell co… Yes          10    77      13.0 
 6 Makarov  Epipelagic CC              Cell co… No           67    77      87.0 
 7 Makarov  Mesopelag… CC              Cell co… Yes           0    25       0   
 8 Makarov  Mesopelag… CC              Cell co… No           25    25     100   
 9 Nansen   Epipelagic CC              Cell co… Yes           3    46       6.52
10 Nansen   Epipelagic CC              Cell co… No           43    46      93.5 
# ℹ 110 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Ensure Proportion is numeric</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>morph_feat_proportion<span class="sc">$</span>proportion <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(morph_feat_proportion<span class="sc">$</span>proportion))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Modify Depth labels</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>morph_feat_proportion<span class="sc">$</span>depth <span class="ot">&lt;-</span> <span class="fu">as.character</span>(morph_feat_proportion<span class="sc">$</span>depth)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>morph_feat_proportion<span class="sc">$</span>depth[morph_feat_proportion<span class="sc">$</span>depth <span class="sc">==</span> <span class="st">"Upper"</span>] <span class="ot">&lt;-</span> <span class="st">"Epipelagic"</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>morph_feat_proportion<span class="sc">$</span>depth[morph_feat_proportion<span class="sc">$</span>depth <span class="sc">==</span> <span class="st">"Lower"</span>] <span class="ot">&lt;-</span> <span class="st">"Mesopelagic"</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>morph_feat_proportion<span class="sc">$</span>depth <span class="ot">&lt;-</span> <span class="fu">factor</span>(morph_feat_proportion<span class="sc">$</span>depth, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Epipelagic"</span>, <span class="st">"Mesopelagic"</span>))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(morph_feat_proportion, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  seabasin depth       feature_acronym features criteria counts total proportion
  &lt;chr&gt;    &lt;fct&gt;       &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1 Amundsen Epipelagic  CC              Cell co… Yes           0    54        0  
2 Amundsen Epipelagic  CC              Cell co… No           54    54      100  
3 Amundsen Mesopelagic CC              Cell co… Yes           2    11       18.2
4 Amundsen Mesopelagic CC              Cell co… No            9    11       81.8
5 Makarov  Epipelagic  CC              Cell co… Yes          10    77       13.0
6 Makarov  Epipelagic  CC              Cell co… No           67    77       87.0</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Calculate summary statistics: mean only</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="do">##Ensure all combinations of MorphologicalFeatures, depth, and criteria are present</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>morph_feat_summary <span class="ot">&lt;-</span> morph_feat_proportion <span class="sc">|&gt;</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(depth, feature_acronym, criteria) <span class="sc">|&gt;</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_proportion =</span> <span class="fu">mean</span>(proportion, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(morph_feat_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Heatmap to show plot</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="do">##Capture original order (assumes it's the order in the dataset)</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>original_order <span class="ot">&lt;-</span> <span class="fu">unique</span>(morph_feat_summary<span class="sc">$</span>feature_acronym)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="do">##List of significant features</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>significant_features <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TL-EPS"</span>, <span class="st">"VL"</span>, <span class="st">"TL"</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="do">##Modify f1_summary Feature labels</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>morph_feat_summary <span class="ot">&lt;-</span> morph_feat_summary <span class="sc">|&gt;</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">feature_starred =</span> <span class="fu">ifelse</span>(</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>      feature_acronym <span class="sc">%in%</span> significant_features,</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"** "</span>, feature_acronym),</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># or "* " / "** " based on threshold</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>      feature_acronym</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(morph_feat_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 5
   depth      feature_acronym criteria mean_proportion feature_starred
   &lt;fct&gt;      &lt;chr&gt;           &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;          
 1 Epipelagic CC              No                 93.5  CC             
 2 Epipelagic CC              Yes                 6.50 CC             
 3 Epipelagic CD              No                 97.7  CD             
 4 Epipelagic CD              Yes                 2.35 CD             
 5 Epipelagic EPS             No                 71.0  EPS            
 6 Epipelagic EPS             Yes                29.0  EPS            
 7 Epipelagic FL              No                100    FL             
 8 Epipelagic FL              Yes                 0    FL             
 9 Epipelagic MB              No                 57.0  MB             
10 Epipelagic MB              Yes                43.0  MB             
# ℹ 30 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Match the new feature_starred factor to the original order</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>morph_feat_summary <span class="ot">&lt;-</span> morph_feat_summary <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feature_starred =</span> <span class="fu">factor</span>(</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    feature_starred,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">ifelse</span>(</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>      original_order <span class="sc">%in%</span> significant_features,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"** "</span>, original_order),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>      original_order</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(morph_feat_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 5
   depth      feature_acronym criteria mean_proportion feature_starred
   &lt;fct&gt;      &lt;chr&gt;           &lt;chr&gt;              &lt;dbl&gt; &lt;fct&gt;          
 1 Epipelagic CC              No                 93.5  CC             
 2 Epipelagic CC              Yes                 6.50 CC             
 3 Epipelagic CD              No                 97.7  CD             
 4 Epipelagic CD              Yes                 2.35 CD             
 5 Epipelagic EPS             No                 71.0  EPS            
 6 Epipelagic EPS             Yes                29.0  EPS            
 7 Epipelagic FL              No                100    FL             
 8 Epipelagic FL              Yes                 0    FL             
 9 Epipelagic MB              No                 57.0  MB             
10 Epipelagic MB              Yes                43.0  MB             
# ℹ 30 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Plot the heatmap</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>EFa_SEM <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(morph_feat_summary,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> criteria, <span class="at">y =</span> feature_starred, <span class="at">fill =</span> mean_proportion)) <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"cividis"</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"proportion (%)"</span>) <span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> depth) <span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Criteria"</span>, <span class="at">y =</span> <span class="st">"Morphological features"</span>) <span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"sans"</span>),</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="cn">NA</span></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"lines"</span>)</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>EFa_SEM</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a><span class="do">##Save the plot as png</span></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"EFa_SEM.png"</span>,</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"figures"</span>,</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">95</span>,</span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">80</span>,</span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"mm"</span>,</span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-EFa" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-EFa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sas21-sem_files/figure-html/fig-EFa-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-EFa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Distribution of morphological features
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="molar-percentages-between-prokaryotic-cells-and-vesicle-like-structures" class="level1">
<h1>Molar percentages between prokaryotic cells and vesicle like structures</h1>
<p><a href="#fig-EFb" class="quarto-xref">Figure&nbsp;7</a> shows the elemental differences between prokaryotic cells and vesicle like structures</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Fig.EFb:Plot Prokaryotic cell vs Vesicle like structures in mol %</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="do">##Read specific sheet by name</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>edx_cell_VL <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"./data/rawdata.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"cell_VL"</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(edx_cell_VL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Summary statistcis of mol ratio</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>summary_edx_cell_VL <span class="ot">&lt;-</span> edx_cell_VL <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, element) <span class="sc">|&gt;</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(mol_percent, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(mol_percent, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span> (<span class="fu">n</span>()),</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI =</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="do">##View the summary statistics</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_edx_cell_VL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
  category                element   mean     se     n    CI
  &lt;chr&gt;                   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Prokaryotic cell        C       92.1   0.431     87 0.844
2 Prokaryotic cell        Mg       0.514 0.0895    14 0.175
3 Prokaryotic cell        N        7.04  0.361     87 0.707
4 Prokaryotic cell        P        0.836 0.233     84 0.456
5 Vesicle-like structures C       79.0   1.57      49 3.07 
6 Vesicle-like structures Ca       6.56  0.677     33 1.33 
7 Vesicle-like structures Mg       9.39  1.29      44 2.53 
8 Vesicle-like structures N        2.89  0.256     29 0.501
9 Vesicle-like structures P        6.79  0.350     49 0.685</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Define the outlier removal function based on IQR</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>edx_cell_VL_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># First quartile (25th percentile)</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Third quartile (75th percentile)</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  IQR_value <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1  <span class="co"># Interquartile range</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Calculate the bounds for outliers</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  lower_bound <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_value</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  upper_bound <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_value</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Return only values within the bounds, and mark outliers as NA</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  cleaned_data <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data <span class="sc">&gt;=</span> lower_bound <span class="sc">&amp;</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>                           data <span class="sc">&lt;=</span> upper_bound, data, <span class="cn">NA</span>)</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cleaned_data)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Apply outlier removal by category and molpercent and filter out NA values in a single step</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>edx_cell_VL_no_outliers <span class="ot">&lt;-</span> edx_cell_VL <span class="sc">|&gt;</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, element) <span class="sc">|&gt;</span>  <span class="co"># group by category</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_no_outliers_mol_percent =</span> <span class="fu">edx_cell_VL_outliers</span>(mol_percent)) <span class="sc">|&gt;</span>  </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply outlier removal</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value_no_outliers_mol_percent)) <span class="sc">|&gt;</span>  </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows where Value_no_outliers is NA</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Remove grouping after applying the function</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="do">##View the cleaned data</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(edx_cell_VL_no_outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Calcualte summary statistics</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>summary_edx_cell_VL_no_outliers <span class="ot">&lt;-</span> edx_cell_VL_no_outliers <span class="sc">|&gt;</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, element) <span class="sc">|&gt;</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(value_no_outliers_mol_percent, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> <span class="fu">sd</span> (value_no_outliers_mol_percent, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI =</span> <span class="fl">1.96</span> <span class="sc">*</span> SE</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_edx_cell_VL_no_outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
  category                element median     SE     n     CI
  &lt;chr&gt;                   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
1 Prokaryotic cell        C       92.5   0.350     84 0.686 
2 Prokaryotic cell        Mg       0.354 0.0275    11 0.0539
3 Prokaryotic cell        N        6.95  0.344     86 0.673 
4 Prokaryotic cell        P        0.423 0.0324    81 0.0635
5 Vesicle-like structures C       79.1   0.726     46 1.42  
6 Vesicle-like structures Ca       5.84  0.297     32 0.583 
7 Vesicle-like structures Mg       6.50  0.614     43 1.20  
8 Vesicle-like structures N        3.22  0.119     23 0.233 
9 Vesicle-like structures P        6.90  0.350     49 0.685 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Normality Test (Shapiro-Wilk Test)</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>cell_VL_shapiro_test_C <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(edx_cell_VL_no_outliers<span class="sc">$</span>value_no_outliers_mol_percent[edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="sc">==</span> <span class="st">"C"</span>])</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>cell_VL_shapiro_test_N <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(edx_cell_VL_no_outliers<span class="sc">$</span>value_no_outliers_mol_percent[edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="sc">==</span> <span class="st">"N"</span>])</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>cell_VL_shapiro_test_P <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(edx_cell_VL_no_outliers<span class="sc">$</span>value_no_outliers_mol_percent[edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="sc">==</span> <span class="st">"P"</span>])</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>cell_VL_shapiro_test_Mg <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(edx_cell_VL_no_outliers<span class="sc">$</span>value_no_outliers_mol_percent[edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="sc">==</span> <span class="st">"Mg"</span>])</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="do">##View normality test results</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>cell_VL_shapiro_test_C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  edx_cell_VL_no_outliers$value_no_outliers_mol_percent[edx_cell_VL_no_outliers$element == "C"]
W = 0.92141, p-value = 1.271e-06</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>cell_VL_shapiro_test_N</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  edx_cell_VL_no_outliers$value_no_outliers_mol_percent[edx_cell_VL_no_outliers$element == "N"]
W = 0.96815, p-value = 0.01028</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>cell_VL_shapiro_test_P</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  edx_cell_VL_no_outliers$value_no_outliers_mol_percent[edx_cell_VL_no_outliers$element == "P"]
W = 0.7415, p-value = 7.692e-14</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>cell_VL_shapiro_test_Mg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  edx_cell_VL_no_outliers$value_no_outliers_mol_percent[edx_cell_VL_no_outliers$element == "Mg"]
W = 0.89346, p-value = 0.00017</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Mann-Whitney U test for each element mol % (since data is not normal)</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="do">##For Carbon</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>cell_VL_mann_whitney_C <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(value_no_outliers_mol_percent <span class="sc">~</span> category, <span class="at">data =</span> edx_cell_VL_no_outliers[edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="sc">==</span> <span class="st">"C"</span>, ])</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cell_VL_mann_whitney_C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  value_no_outliers_mol_percent by category
W = 3761, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">##For Nitrogen</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>cell_VL_mann_whitney_N <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(value_no_outliers_mol_percent <span class="sc">~</span> category, <span class="at">data =</span> edx_cell_VL_no_outliers[edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="sc">==</span> <span class="st">"N"</span>, ])</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cell_VL_mann_whitney_N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  value_no_outliers_mol_percent by category
W = 1700, p-value = 1.317e-07
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">##For Phosphorus</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>cell_VL_mann_whitney_P <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(value_no_outliers_mol_percent <span class="sc">~</span> category, <span class="at">data =</span> edx_cell_VL_no_outliers[edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="sc">==</span> <span class="st">"P"</span>, ])</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cell_VL_mann_whitney_P)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  value_no_outliers_mol_percent by category
W = 16, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">##For Magnesium¨</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>cell_VL_mann_whitney_Mg <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(value_no_outliers_mol_percent <span class="sc">~</span> category, <span class="at">data =</span> edx_cell_VL_no_outliers[edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="sc">==</span> <span class="st">"Mg"</span>, ])</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cell_VL_mann_whitney_Mg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  value_no_outliers_mol_percent by category
W = 0, p-value = 2.089e-11
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Ensure 'element' is a factor with the specified levels</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>edx_cell_VL_no_outliers<span class="sc">$</span>element <span class="ot">&lt;-</span> <span class="fu">factor</span>(edx_cell_VL_no_outliers<span class="sc">$</span>element,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"N"</span>, <span class="st">"P"</span>, <span class="st">"Mg"</span>, <span class="st">"Ca"</span>))</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="do">##Plot boxplot for the mol_percent, faceted by category</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>EFb_SEM <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  edx_cell_VL_no_outliers,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> element, <span class="at">y =</span> value_no_outliers_mol_percent , <span class="at">fill =</span> category)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.6</span>,</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim =</span> <span class="cn">TRUE</span>,</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>,</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> category),</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(),</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"cividis"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> element, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">"C"</span> <span class="ot">=</span> <span class="st">"C (n = 84, 46)"</span>,</span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>      <span class="st">"N"</span> <span class="ot">=</span> <span class="st">"N (n = 86, 23)"</span>,</span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>      <span class="st">"P"</span> <span class="ot">=</span> <span class="st">"P (n = 81, 49)"</span>,</span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Ca"</span> <span class="ot">=</span> <span class="st">"Ca (n = 32)"</span>,</span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Mg"</span> <span class="ot">=</span> <span class="st">"Mg (n =11, 43)"</span></span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Elements"</span>, <span class="at">y =</span> <span class="st">"Mol %"</span>, <span class="at">fill =</span> <span class="st">"category"</span>) <span class="sc">+</span></span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"sans"</span>),</span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb100-47"><a href="#cb100-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb100-48"><a href="#cb100-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-49"><a href="#cb100-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(</span>
<span id="cb100-50"><a href="#cb100-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb100-51"><a href="#cb100-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb100-52"><a href="#cb100-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="cn">NA</span></span>
<span id="cb100-53"><a href="#cb100-53" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb100-54"><a href="#cb100-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"Black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb100-55"><a href="#cb100-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"Black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb100-56"><a href="#cb100-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb100-57"><a href="#cb100-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb100-58"><a href="#cb100-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb100-59"><a href="#cb100-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">7</span></span>
<span id="cb100-60"><a href="#cb100-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb100-61"><a href="#cb100-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb100-62"><a href="#cb100-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb100-63"><a href="#cb100-63" aria-hidden="true" tabindex="-1"></a>EFb_SEM</span>
<span id="cb100-64"><a href="#cb100-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-65"><a href="#cb100-65" aria-hidden="true" tabindex="-1"></a><span class="do">##Save the plot</span></span>
<span id="cb100-66"><a href="#cb100-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb100-67"><a href="#cb100-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"EFb_edx_cell_VL.png"</span>,</span>
<span id="cb100-68"><a href="#cb100-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"figures"</span>,</span>
<span id="cb100-69"><a href="#cb100-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> EFb_SEM,</span>
<span id="cb100-70"><a href="#cb100-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">96</span>,</span>
<span id="cb100-71"><a href="#cb100-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">100</span>,</span>
<span id="cb100-72"><a href="#cb100-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"mm"</span>,</span>
<span id="cb100-73"><a href="#cb100-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb100-74"><a href="#cb100-74" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-EFb" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-EFb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sas21-sem_files/figure-html/fig-EFb-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-EFb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Molar percentages of elements in prokaryotic cell and vesicle like structures
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="combined-figures-morphological-features-and-mol-comaprison" class="level1">
<h1>Combined figures: morphological features and mol% comaprison</h1>
<p><a href="#fig-EF" class="quarto-xref">Figure&nbsp;8</a> shows the distribution of morphological features and mol% comparison</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="do">##combine figures</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>ExtendedFig <span class="ot">&lt;-</span> EFa_SEM <span class="sc">+</span> EFb_SEM <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag_levels =</span> <span class="st">'a'</span>,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">##gives 'a' and 'b'</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">"sans"</span>  <span class="do">##Matches Nature's style</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>ExtendedFig</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="do">##Save the plot as png</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"ExtendedFig.png"</span>,</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"figures"</span>,</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> ExtendedFig,</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">180</span>,</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">120</span>,</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"mm"</span>,</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="do">##Save the plot as pdf</span></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"ExtendedFig.pdf"</span>,</span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"figures"</span>,</span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> ExtendedFig,</span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">180</span>,</span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">120</span>,</span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"mm"</span>,</span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">500</span></span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-EF" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-EF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sas21-sem_files/figure-html/fig-EF-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-EF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Morphological features and mol% comparison
</figcaption>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>